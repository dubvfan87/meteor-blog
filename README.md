## Blog

This Meteor package gives you a basic, out-of-the-box blog at `/blog`. We wanted
a way to add a blog to an existing app without running another dyno or server
for a meteor-based blog.

### Features

* Froala editor
* Slug-based URLs (editable)
* Add blog post images (store in database or upload to S3)
* Add featured, "hero" image for a post
* Support socialize:commentable comments
* Blog post tags and tag view
* Widget to embed recent posts on another (e.g. home) page
* Customizable templates
* Autosave
* Pagination
* Multiple roles (admin/author)

### Quick Start

```bash
$ meteor add mattimo:blog
```

You will get routes for:

```
/blog
/admin/blog
```

`/admin/blog` requires that `Meteor.user()` return a user.

# Usage

### Roles

By default, _any_ logged-in user can administer the blog. To ensure that only
select users can edit the blog, the package supports two roles:

* `adminRole` - Can create, and modify or delete any post.
* `authorRole` - Can create, and modify or delete only my own posts.

To enable either or both roles, specify values in the blog config:

```coffee
# CoffeeScript
if Meteor.isServer
  Blog.config
    adminRole: 'blogAdmin'
    authorRole: 'blogAuthor'
```

```javascript
// JavaScript
if (Meteor.isServer) {
  Blog.config({
    adminRole: 'blogAdmin',
    authorRole: 'blogAuthor'
  });
}
```

Then, you need to give blog users that role. Currently, you're on your own to
add these roles somehow:

* Add these directly to admin users in the database (`"roles": ["blogAdmin"]`), or
* Roll your own admin page using the methods provided by [meteor-roles](https://atmosphere.meteor.com/package/roles), or
* Use an accounts admin package like [accounts-admin-ui-bootstrap-3](https://atmosphere.meteor.com/package/accounts-admin-ui-bootstrap-3).

### Comments

**Socialize Commentable**



### Bootstrap Templates

Meteor blog works out-of-the-box with minimal, decent-looking Bootstrap
templates. If you use these default templates, you must add the meteor
`bootstrap-3` package.

```bash
$ meteor add mizzao:bootstrap-3
```

### Custom Templates

While the admin templates are opinionated, the front-end is bare markup, ready
to by styled. If the default templates aren't doing it for you, you can override
the default templates with your own by setting configuration variables:

```coffee
# CoffeeScript
if Meteor.isClient
  Blog.config
    blogIndexTemplate: 'myBlogIndexTemplate' # '/blog' route
    blogShowTemplate: 'myShowBlogTemplate'   # '/blog/:slug' route
```
```javascript
// JavaScript
if (Meteor.isClient) {
  Blog.config({
    blogIndexTemplate: 'myBlogIndexTemplate',
    blogShowTemplate: 'myShowBlogTemplate'
  });
}
```

In your templates, you can use these Handlebars helpers provided by the package
to display blog posts with some basic, semantic markup:

* `{{> blogIndex}}` - Renders list of blog posts (`/blog` route)
* `{{> blogShow}}` - Renders single blog post (`/blog/:slug` route)

Example:

```html
<template name="myBlogIndexTemplate">
  <h1>Welcome to my Blog</h1>
  <div>{{> blogIndex}}</div>
</template>
```

If you don't want any of our markup, use the blog data provided in the template
context directly:

* `posts` - Collection of [`minimongoid`](https://github.com/Exygy/minimongoid) blog post objects (`/blog` route)
* `this` - [`minimongoid`](https://github.com/Exygy/minimongoid) blog post object (`/blog/:slug` route)

Example:

```html
<template name="myBlogIndexTemplate">
  <h1>Welcome to my Blog</h1>
  <ul>
    {{#each posts}}
      <li>
        <h2>{{title}}</h2>
        <p>Published on {{publishedAt}}</p>
        <p>Excerpt: {{excerpt}}</p>
      </li>
    {{/each}}
  </ul>
</template>
```

**Custom NotFound**

You can provide a custom `notFoundTemplate` to use when a blog post slug is not
found.

```coffee
# CoffeeScript
if Meteor.isClient
  Blog.config
    blogNotFoundTemplate: 'myNotFoundTemplate'
```

```javascript
// JavaScript
if (Meteor.isClient) {
  Blog.config({
    blogNotFoundTemplate: 'myNotFoundTemplate'
  });
}
```

### Blog Post Excerpt

By default, blog summaries or excerpts are generated by taking the 1st paragraph
from the blog post. You can override this function by configuring a custom
`excerptFunction`. For example, if you wanted to create an excerpt from the 1st
sentence:

```coffee
# CoffeeScript
if Meteor.isClient
  Blog.config
    excerptFunction: (body) ->
      body.split('.')[0] + '.'
```
```javascript
// JavaScript
if (Meteor.isClient) {
  Blog.config({
    excerptFunction: function(body) {
      return body.split('.')[0] + '.';
    }
  });
}
```


### Images

Adding images to your blog posts works out of the box and saves the images to
gridFS in your Mongo database. You can optionally have these images to an Amazon
S3 bucket that you configure.

To setup S3 for file storage, add the following in `/settings.json` (or any
other location of your choice).

```json
{
  "public": {
    "blog": {
      "useS3": true
    }
  },
  "private": {
    "blog": {
      "s3Config": {
        "bucket": "you-bucket-name",
        "ACL": "public-read",
        "MaxTries": 2,
        "accessKeyId": "XXXXXXXXXXXXX",
        "secretAccessKey": "xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx",
        "region": "OPTIONAL most of the time"
      }
    }
  }
}
```

### Pagination

By default, blog posts are paged in 20 at a time.  You can modify this value in
settings. Set to `null` to turn off paging entirely.

```coffee
# CoffeeScript
if Meteor.isClient
  Blog.config
    pageSize: 10
```

```javascript
// JavaScript
if (Meteor.isClient) {
  Blog.config({
    pageSize: 10
  });
}
```

The default `blogIndexTemplate` template displays a `Load More` button. If you
use your own template, include the `{{blogPager}}` helper to display the button.

### Recent Posts Helper

You can include a basic snippet of HTML displaying recent blog posts (e.g. on
your home page). Insert the inclusion helper where you want the recent posts to
appear.

```html
{{> blogLatest}}
```

Or you can specify the # of posts to show:

```html
{{> blogLatest num=5}}
```

There are classes in the template for styling.
